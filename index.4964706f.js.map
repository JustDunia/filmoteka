{"mappings":"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","sources":["src/js/movie-details.js"],"sourcesContent":["import axios from 'axios';\nimport { idToGenereTranslate, modalToggle } from './helpers';\n\nconst gallery = document.querySelector('.movie-container');\nconst overview = document.querySelector('.overview');\nconst closeModal = document.querySelector('.modalClose');\nconst API_KEY = '4e9fa3fc2487236fdff94602c5bb9552';\n\nconst watchButton = document.querySelector('.watch');\nconst queueButton = document.querySelector('.que');\n\nconst spinner = document.querySelector('.sk-chase');\nlet exportData;\n\ncloseModal.onclick = modalToggle;\n\nconst fetchProvider = async (id = 1771) => {\n  const table = await axios.get(\n    `\nhttps://api.themoviedb.org/3/movie/${id}/watch/providers?api_key=4e9fa3fc2487236fdff94602c5bb9552`,\n  );\n  return table;\n};\n\nconst fetchGenere = async q => {\n  const table = await axios.get(\n    `\nhttps://youtube.googleapis.com/youtube/v3/search?q=${q}&key=AIzaSyB8TTc_5353cPL4Gqfo9xPQBbRH9hfG-YA`,\n  );\n  return table;\n};\n\nfunction gatherDetailsProv(response) {\n  const table = response.data.results.PL;\n  if (table !== undefined && table.flatrate !== undefined) {\n    const NMark = `<a href=\"https://www.netflix.com/search?q=${exportData.title}\" target=\"_blank\" rel=\"noreferrer noopener\"><image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${table.flatrate[0].logo_path}\" width=\"50\" height=\"50\"></a>   \n   `;\n\n    const markupList = table.flatrate\n      .filter(image => image.provider_name !== 'Netflix')\n      .map(\n        image => `<image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${image.logo_path}\" width=\"50\" height=\"50\">   \n   `,\n      )\n      .join(``);\n    overview.insertAdjacentHTML('beforeend', `<p class=\"mod-ab\">STREAM</p>`);\n    if (table.flatrate[0].provider_name === 'Netflix') {\n      overview.insertAdjacentHTML('beforeend', NMark);\n    }\n    overview.insertAdjacentHTML('beforeend', markupList);\n    document.querySelector('.mod--buttons').classList.remove('mod--buttons-alt');\n  } else {\n    document.querySelector('.mod--buttons').classList.add('mod--buttons-alt');\n  }\n}\n\nfunction gatherDetailsForYt(response) {\n  const table = response.data;\n  detailsObjectYouTube = {\n    snipet: table.items[0].id.videoId,\n  };\n}\n\nconst vplayer = document.querySelectorAll('.vplayer');\n\nfunction YoutubeLoad(q) {\n  const vplayer = document.querySelectorAll('.vplayer');\n\n  for (let i = 0; i < vplayer.length; i++) {\n    const source = `https://img.youtube.com/vi/${q}/sddefault.jpg`;\n\n    const image = new Image();\n    image.src = source;\n    image.addEventListener(\n      'load',\n      (function () {\n        vplayer[i].appendChild(image);\n      })(i),\n    );\n\n    function LoadYT() {\n      const iframe = document.createElement('iframe');\n      iframe.setAttribute('allowfullscreen', '');\n      iframe.setAttribute('frameborder', '0');\n      iframe.setAttribute('src', `https://www.youtube.com/embed/${q}?rel=0&showinfo=0`);\n      vplayer[i].innerHTML = '';\n      vplayer[i].appendChild(iframe);\n    }\n    LoadYT();\n  }\n}\n\n// Zapytanie do API TMDB zwraca obiekt odpowiedzi\nconst fetchDetails = async (id = 1771) => {\n  spinner.classList.remove('hidden');\n  const table = await axios.get(`\n\nhttps://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=en-US`);\n  return table;\n};\n\n// Renderowanie zawartości modala\nfunction renderDetails(response) {\n  const table = response.data;\n  exportData = response.data;\n\n  const markupList = `<div class=\"mod-div-img\"><image class=\"mod-img\" src=\"https://image.tmdb.org/t/p/w500${\n    table.poster_path\n  }\"><div><h2 class=\"mod-title\">${table.title.toUpperCase()}</h2>\n  <div class=\"row\">\n<div class = \"columnA\">\n  <p class=\"space\">Vote / Votes</p>\n  <p class=\"space\">Popularity</p>\n  <p class=\"space\">Original Title</p>\n  <p class=\"space\">Genre</p>\n  </div>\n     <div class = \"columnB\">\n     <p class=\"space\"><span class=\"vote-mod\">${table.vote_average.toFixed(\n       1,\n     )}</span> / <span class=\"votes-mod\">${table.vote_count}</p>\n     <p class=\"space\">${table.popularity.toFixed(1)}</p></b>\n     <p class=\"space\">${table.original_title.toUpperCase()}</p>\n     <p class=\"space\">${table.genres.map(element => idToGenereTranslate(element.id)).join(`, `)}  \n     </p> \n     </div></div>  \n  <h3 class=\"mod-about\">ABOUT</h3>\n      <p class=\"mod-about-content\">${table.overview}</p>\n  `;\n  overview.insertAdjacentHTML(\n    'afterbegin',\n    markupList.replaceAll(\n      'https://image.tmdb.org/t/p/w500null',\n      'https://mateuszwoj-bit.github.io/GOIT-team-project-ice/squoosh-how1-desktop.b9f13a59.png',\n    ),\n  );\n  spinner.classList.add('hidden');\n}\n\n//Pobiera informacje z atrybutów plakatu filmu (IMG)\nfunction handleDetailClick(event) {\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n  overview.innerHTML = '';\n  modalToggle();\n  fetchDetails(event.target.getAttribute('movieID'))\n    .then(function (response) {\n      // handle success\n      renderDetails(response);\n      watchButton.innerHTML = 'ADD TO WATCHED';\n      watchButton.classList.remove('btn-mod-color');\n      queueButton.innerHTML = 'ADD TO QUEUE';\n      queueButton.classList.remove('btn-mod-color');\n      const parsedWatch = JSON.parse(localStorage.getItem('WATCH_KEY'));\n      const parsedQue = JSON.parse(localStorage.getItem('QUEUE_KEY'));\n      if (parsedWatch.find(movie => movie.title === exportData.title)) {\n        watchButton.innerHTML = 'ADDED TO WATCHED';\n        watchButton.classList.add('btn-mod-color');\n      }\n      if (parsedQue.find(movie => movie.title === exportData.title)) {\n        queueButton.innerHTML = 'ADDED TO QUEUE';\n        queueButton.classList.add('btn-mod-color');\n      }\n    })\n    .then(\n      fetchProvider(event.target.getAttribute('movieID'))\n        .then(function (response) {\n          // handle success\n          gatherDetailsProv(response);\n        })\n        .catch(function (error) {\n          // handle error\n          console.log(error);\n        }),\n    )\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n  fetchGenere(event.target.getAttribute('movietitle'))\n    .then(function (response) {\n      // handle success\n      gatherDetailsForYt(response);\n      YoutubeLoad(detailsObjectYouTube.snipet);\n    })\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n}\n\ngallery.onclick = handleDetailClick;\nexport { exportData };\n"],"names":["$hGVxz","parcelRequire","$db99a8d496574cdc$var$gallery","document","querySelector","$db99a8d496574cdc$var$overview","$db99a8d496574cdc$var$closeModal","$db99a8d496574cdc$var$watchButton","$db99a8d496574cdc$var$queueButton","$db99a8d496574cdc$var$spinner","$db99a8d496574cdc$export$5e3bc6f9d5e187a3","onclick","$48Q3A","modalToggle","querySelectorAll","event","target","nodeName","innerHTML","async","id","classList","remove","default","get","$db99a8d496574cdc$var$fetchDetails","getAttribute","then","response","table","data","markupList","poster_path","title","toUpperCase","vote_average","toFixed","vote_count","popularity","original_title","genres","map","element","idToGenereTranslate","join","overview","insertAdjacentHTML","replaceAll","add","$db99a8d496574cdc$var$renderDetails","parsedWatch","JSON","parse","localStorage","getItem","parsedQue","find","movie","$db99a8d496574cdc$var$fetchProvider","results","PL","undefined","flatrate","NMark","logo_path","filter","image","provider_name","$db99a8d496574cdc$var$gatherDetailsProv","catch","error","console","log","q","$db99a8d496574cdc$var$fetchGenere","detailsObjectYouTube","snipet","items","videoId","$db99a8d496574cdc$var$gatherDetailsForYt","vplayer","i","length","source","Image","LoadYT","iframe","createElement","setAttribute","appendChild","src","addEventListener","$db99a8d496574cdc$var$YoutubeLoad"],"version":3,"file":"index.4964706f.js.map"}