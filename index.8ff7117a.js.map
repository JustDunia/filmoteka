{"mappings":"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","sources":["src/js/movie-details.js"],"sourcesContent":["import axios from 'axios';\nimport { idToGenereTranslate, modalToggle } from './helpers';\n\nconst gallery = document.querySelector('.movie-container');\nconst overview = document.querySelector('.overview');\nconst closeModal = document.querySelector('.modalClose');\nconst API_KEY = '4e9fa3fc2487236fdff94602c5bb9552';\n\nconst watchButton = document.querySelector('.watch');\nconst queueButton = document.querySelector('.que');\n\nconst spinner = document.querySelector('.sk-chase');\nlet exportData;\nlet detailsObjectYouTube;\n\ncloseModal.onclick = modalToggle;\n\nconst fetchProvider = async (id = 1771) => {\n  const table = await axios.get(\n    `\nhttps://api.themoviedb.org/3/movie/${id}/watch/providers?api_key=4e9fa3fc2487236fdff94602c5bb9552`,\n  );\n  return table;\n};\n\nconst fetchGenere = async q => {\n  const table = await axios.get(\n    `\nhttps://youtube.googleapis.com/youtube/v3/search?q=${q}&key=AIzaSyB8TTc_5353cPL4Gqfo9xPQBbRH9hfG-YA`,\n  );\n  return table;\n};\n\nfunction gatherDetailsProv(response) {\n  const table = response.data.results.PL;\n  if (table !== undefined && table.flatrate !== undefined) {\n    const NMark = `<a href=\"https://www.netflix.com/search?q=${exportData.title}\" target=\"_blank\" rel=\"noreferrer noopener\"><image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${table.flatrate[0].logo_path}\" width=\"50\" height=\"50\"></a>   \n   `;\n\n    const markupList = table.flatrate\n      .filter(image => image.provider_name !== 'Netflix')\n      .map(\n        image => `<image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${image.logo_path}\" width=\"50\" height=\"50\">   \n   `,\n      )\n      .join(``);\n    overview.insertAdjacentHTML('beforeend', `<p class=\"mod-ab\">STREAM</p>`);\n    if (table.flatrate[0].provider_name === 'Netflix') {\n      overview.insertAdjacentHTML('beforeend', NMark);\n    }\n    overview.insertAdjacentHTML('beforeend', markupList);\n    document.querySelector('.mod--buttons').classList.remove('mod--buttons-alt');\n  } else {\n    document.querySelector('.mod--buttons').classList.add('mod--buttons-alt');\n  }\n}\n\nfunction gatherDetailsForYt(response) {\n  const table = response.data;\n  detailsObjectYouTube = {\n    snipet: table.items[0].id.videoId,\n  };\n}\n\nconst vplayer = document.querySelectorAll('.vplayer');\n\nfunction YoutubeLoad(q) {\n  const vplayer = document.querySelectorAll('.vplayer');\n\n  for (let i = 0; i < vplayer.length; i++) {\n    const source = `https://img.youtube.com/vi/${q}/sddefault.jpg`;\n\n    const image = new Image();\n    image.src = source;\n    image.addEventListener(\n      'load',\n      (function () {\n        vplayer[i].appendChild(image);\n      })(i),\n    );\n\n    function LoadYT() {\n      const iframe = document.createElement('iframe');\n      iframe.setAttribute('allowfullscreen', '');\n      iframe.setAttribute('frameborder', '0');\n      iframe.setAttribute('src', `https://www.youtube.com/embed/${q}?rel=0&showinfo=0`);\n      vplayer[i].innerHTML = '';\n      vplayer[i].appendChild(iframe);\n    }\n    LoadYT();\n  }\n}\n\n// Zapytanie do API TMDB zwraca obiekt odpowiedzi\nconst fetchDetails = async (id = 1771) => {\n  spinner.classList.remove('hidden');\n  const table = await axios.get(`\n\nhttps://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=en-US`);\n  return table;\n};\n\n// Renderowanie zawartości modala\nfunction renderDetails(response) {\n  const table = response.data;\n  exportData = response.data;\n\n  const markupList = `<div class=\"mod-div-img\"><image class=\"mod-img\" src=\"https://image.tmdb.org/t/p/w500${\n    table.poster_path\n  }\"><div><h2 class=\"mod-title\">${table.title.toUpperCase()}</h2>\n  <div class=\"row\">\n<div class = \"columnA\">\n  <p class=\"space\">Vote / Votes</p>\n  <p class=\"space\">Popularity</p>\n  <p class=\"space\">Original Title</p>\n  <p class=\"space\">Genre</p>\n  </div>\n     <div class = \"columnB\">\n     <p class=\"space\"><span class=\"vote-mod\">${table.vote_average.toFixed(\n       1,\n     )}</span> / <span class=\"votes-mod\">${table.vote_count}</p>\n     <p class=\"space\">${table.popularity.toFixed(1)}</p></b>\n     <p class=\"space\">${table.original_title.toUpperCase()}</p>\n     <p class=\"space\">${table.genres.map(element => idToGenereTranslate(element.id)).join(`, `)}  \n     </p> \n     </div></div>  \n  <h3 class=\"mod-about\">ABOUT</h3>\n      <p class=\"mod-about-content\">${table.overview}</p>\n  `;\n  overview.insertAdjacentHTML(\n    'afterbegin',\n    markupList.replaceAll(\n      'https://image.tmdb.org/t/p/w500null',\n      'https://mateuszwoj-bit.github.io/GOIT-team-project-ice/squoosh-how1-desktop.b9f13a59.png',\n    ),\n  );\n  spinner.classList.add('hidden');\n}\n\n//Pobiera informacje z atrybutów plakatu filmu (IMG)\nfunction handleDetailClick(event) {\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n  overview.innerHTML = '';\n  modalToggle();\n  fetchDetails(event.target.getAttribute('movieID'))\n    .then(function (response) {\n      // handle success\n      renderDetails(response);\n      watchButton.innerHTML = 'ADD TO WATCHED';\n      watchButton.classList.remove('btn-mod-color');\n      queueButton.innerHTML = 'ADD TO QUEUE';\n      queueButton.classList.remove('btn-mod-color');\n      const parsedWatch = JSON.parse(localStorage.getItem('WATCH_KEY'));\n      const parsedQue = JSON.parse(localStorage.getItem('QUEUE_KEY'));\n      if (\n        (Array.isArray(parsedWatch) && parsedWatch.length) ||\n        (Array.isArray(parsedQue) && parsedQue.length)\n      ) {\n        if (parsedWatch && parsedWatch.length && exportData.title) {\n          const watchedMovie = parsedWatch.find(movie => movie.title === exportData.title);\n          if (watchedMovie) {\n            watchButton.innerHTML = 'ADDED TO WATCHED';\n            watchButton.classList.add('btn-mod-color');\n          }\n        }\n        if (parsedQue && parsedQue.length && exportData.title) {\n          const queueMovie = parsedQue.find(movie => movie.title === exportData.title);\n          if (queueMovie) {\n            queueButton.innerHTML = 'ADDED TO QUEUE';\n            queueButton.classList.add('btn-mod-color');\n          }\n        }\n      }\n    })\n    .then(\n      fetchProvider(event.target.getAttribute('movieID'))\n        .then(function (response) {\n          // handle success\n          gatherDetailsProv(response);\n        })\n        .catch(function (error) {\n          // handle error\n          console.log(error);\n        }),\n    )\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n  fetchGenere(event.target.getAttribute('movietitle'))\n    .then(function (response) {\n      // handle success\n      gatherDetailsForYt(response);\n      YoutubeLoad(detailsObjectYouTube.snipet);\n    })\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n}\n\ngallery.onclick = handleDetailClick;\nexport { exportData };\n"],"names":["$hGVxz","parcelRequire","$db99a8d496574cdc$var$gallery","document","querySelector","$db99a8d496574cdc$var$overview","$db99a8d496574cdc$var$closeModal","$db99a8d496574cdc$var$watchButton","$db99a8d496574cdc$var$queueButton","$db99a8d496574cdc$var$spinner","$db99a8d496574cdc$export$5e3bc6f9d5e187a3","$db99a8d496574cdc$var$detailsObjectYouTube","onclick","$48Q3A","modalToggle","querySelectorAll","event","target","nodeName","innerHTML","async","id","classList","remove","default","get","$db99a8d496574cdc$var$fetchDetails","getAttribute","then","response","table","data","markupList","poster_path","title","toUpperCase","vote_average","toFixed","vote_count","popularity","original_title","genres","map","element","idToGenereTranslate","join","overview","insertAdjacentHTML","replaceAll","add","$db99a8d496574cdc$var$renderDetails","parsedWatch","JSON","parse","localStorage","getItem","parsedQue","Array","isArray","length","find","movie","$db99a8d496574cdc$var$fetchProvider","results","PL","undefined","flatrate","NMark","logo_path","filter","image","provider_name","$db99a8d496574cdc$var$gatherDetailsProv","catch","error","console","log","q","$db99a8d496574cdc$var$fetchGenere","snipet","items","videoId","$db99a8d496574cdc$var$gatherDetailsForYt","vplayer","i","source","Image","LoadYT","iframe","createElement","setAttribute","appendChild","src","addEventListener","$db99a8d496574cdc$var$YoutubeLoad"],"version":3,"file":"index.8ff7117a.js.map"}